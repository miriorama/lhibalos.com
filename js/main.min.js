class Balos{static init(){Balos.menuToggle=document.querySelector(".menu-toggle"),Balos.nav=document.querySelector(".nav"),Balos.revealItems=document.querySelectorAll(".reveal"),Balos.lyricsButtons=document.querySelectorAll(".lyrics-list button"),Balos.modal=document.getElementById("lyrics-modal"),Balos.modalContent=Balos.modal?.querySelector(".modal-content"),Balos.modalTitle=Balos.modal?.querySelector("#modal-title"),Balos.stackContainers=document.querySelectorAll(".hero-stack, .photo-stack"),Balos.badge=document.querySelector(".badge"),Balos.badgeTicking=!1,Balos.initReveal(),Balos.initLyricsModal(),Balos.initStacks(),Balos.initBadgeRotation()}static openMenu(){Balos.nav.classList.toggle("open")}static closeMenu(){Balos.nav.classList.remove("open")}static initReveal(){if(0===Balos.revealItems.length)return;const t=new IntersectionObserver((e=>{e.forEach(((e,o)=>{e.isIntersecting&&(e.target.style.transitionDelay=80*o+"ms",e.target.classList.add("visible"),t.unobserve(e.target))}))}),{threshold:.2});Balos.revealItems.forEach((e=>t.observe(e)))}static initLyricsModal(){Balos.lyricsButtons.forEach((t=>{t.addEventListener("click",(()=>{const e=t.getAttribute("data-src");e&&Balos.openModal(t.textContent.trim(),e)}))})),Balos.modal&&Balos.modal.addEventListener("click",(t=>{t.target.closest('[data-close="true"]')&&Balos.closeModal()})),document.addEventListener("keydown",Balos.handleEscape)}static initStacks(){Balos.stackContainers.forEach((t=>{t.addEventListener("click",(e=>{const o=e.target;if(!(o instanceof HTMLElement))return;const a=o.closest(".stack-item");a&&t.contains(a)&&t.insertBefore(a,t.firstChild)}))}))}static initBadgeRotation(){Balos.badge&&window.addEventListener("scroll",(()=>{Balos.badgeTicking||(Balos.badgeTicking=!0,requestAnimationFrame(Balos.updateBadgeRotation))}))}static handleEscape(t){"Escape"===t.key&&Balos.closeModal()}static closeModal(){Balos.modal&&(Balos.modal.classList.remove("open"),Balos.modal.setAttribute("aria-hidden","true"),document.body.style.overflow="",Balos.modalContent&&(Balos.modalContent.innerHTML=""))}static async openModal(t,e){if(Balos.modal&&Balos.modalContent){Balos.modal.classList.add("open"),Balos.modal.setAttribute("aria-hidden","false"),Balos.modalTitle.textContent=t,document.body.style.overflow="hidden",Balos.modalContent.textContent="Caricamento...";try{const t=await fetch(e);if(!t.ok)throw new Error("Errore caricamento");const o=(await t.text()).trim();if(!o)throw new Error("Testo non disponibile.");Balos.modalContent.innerHTML=o}catch(t){Balos.modalContent.textContent="Impossibile caricare il testo."}}}static updateBadgeRotation(){Balos.badge&&(Balos.badge.style.transform=`rotate(${.02*window.scrollY}deg)`,Balos.badgeTicking=!1)}}document.addEventListener("DOMContentLoaded",(()=>{Balos.init()}));